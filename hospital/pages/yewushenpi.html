<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Spica Admin</title>
  
  <link rel="stylesheet" href="../css/style.css">
  <!-- endinject -->
  <script src="../js/vue.js"></script>
  <script src="../js/axios.min.js"></script>
</head>

<body>
  <div class="container-scroller d-flex">
    <!-- partial:../../partials/_sidebar.html -->
    
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row" id="sv1">
            
            <div class="col-lg-12 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">审批业务</h4>
                  <p class="card-description">
                     <select v-model="s1" @change="aaa();">
						 <option value="未审核">未审核</option>
						 <option value="已审核">已审核</option>
					 </select>
                  </p>
                  <div class="table-responsive pt-3">
                    <table class="table table-dark">
                      <thead>
                        <tr>
                          <th>
                            编号
                          </th>
                          <th>
                            标题
                          </th>
                          <th>
                            申请人
                          </th>
                          <th>
                            状态
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr v-for="(d,index) in ds" style="cursor:pointer;" @click="st(index);" >
                          <td>
                            {{index}}
                          </td>
                          <td>
                            {{d.sname}}
                          </td>
                          <td>
                            {{d.realname}}
                          </td>
                          <td>
                            {{d.zt}}
                          </td>
                        </tr>
                        
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
			  
            </div>
            <div class="col-12 grid-margin stretch-card" v-show="show1">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">详细信息</h4>
                  
                  
                    <div class="form-group">
                      <label for="exampleInputName1">标题</label>
                     {{d1.sname}}
                    </div>
                    <div class="form-group">
                      <label for="exampleInputEmail3">申请人</label>
                      {{d1.realname}}
                    </div>
                    
                    
                    
                    <div class="form-group">
                      <label for="exampleTextarea1">内容</label>
                      {{d1.scontext}}
                    </div>
                    <button type="button" class="btn btn-primary mr-2" @click="tg();" v-show="show2">已审核</button>
                    <button class="btn btn-light" @click="wtg();" v-show="show2">未通过</button>
                  
                </div>
              </div>
            </div>
			
			
			
			
			
          </div>
		  
		  <script>
		  	var app1=new Vue({
		  		el:"#sv1",
		  		data:{
		  			s1:"未审核",
		  			ds:[],
					d1:{},
					show1:false,
					show2:true
		  		},
		  		created: function() {
		  			
		  			this.aaa();
		  			
		  		},
		  		methods:{
		  			aaa:function(){
		  				var uid=window.localStorage.getItem("uid");
		  				
		  				
		  				axios.get("../yewushenpi?uid="+uid+"&zt="+this.s1)
		  				  .then((res) => {
		  					  app1.ds=res.data;
		  					//console.log(response.data);//请求的返回体
		  				  })
		  				  .catch((error) => {
		  					console.log(error);//异常
		  				  });
		  			},
		  			st:function(ind){
		  				this.d1=this.ds[ind];
						this.show1=true;
						if(this.s1=="未审核"){
							this.show2=true;
						}else{
							this.show2=false;
						}
		  			},
					tg:function(){
						
						axios.get("../shenhe?id="+this.d1.id+"&zt=已审核")
						  .then((res) => {
							  alert("审核通过");
							  app1.show1=false;
							  app1.aaa();
							//console.log(response.data);//请求的返回体
						  })
						  .catch((error) => {
							console.log(error);//异常
						  });
					},
					wtg:function(){
						axios.get("../shenhe?id="+this.d1.id+"&zt=审核未通过")
						  .then((res) => {
							  alert("审核未通过");
							  app1.show1=false;
							  app1.aaa();
							//console.log(response.data);//请求的返回体
						  })
						  .catch((error) => {
							console.log(error);//异常
						  });
					}
		  		}
		  	});
		  </script>
		  
		  
        </div>
        <!-- content-wrapper ends -->
        
      </div>
      <!-- main-panel ends -->
    </div>
    <!-- page-body-wrapper ends -->
  </div>
  
</body>

</html>
